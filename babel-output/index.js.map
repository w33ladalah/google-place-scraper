{"version":3,"sources":["../src/index.js"],"names":["_setting","JSONdb","_logger","Logger","_filePaths","FilePaths","_ipcRenderer","electron","ipcRenderer","_puppeteerWrapper","PuppeteerWrapper","headless","width","height","scrapedData","main","_getSavedPath","setPlatformText","getNetworkInterface","text","get","on","e","preventDefault","html","removeClass","addClass","searchQuery","val","searchLimit","parseInt","send","attr","GMapScrapper","cleanup","removeAttr","target","loadWebViewPage","email","key","validateLicense","os","type","platform","arch","release","interfaces","networkInterfaces","hasOwnProperty","wirelessNetwork","forEach","ifcs","mac","licenseKey","signature","undefined","console","log","signatureParams","hostname","signatureHash","set","baseUrl","licenseServerUrl","response","axios","licenseData","data","status","ex","getPageData","url","page","goto","waitForSelector","shopName","$eval","name","textContent","reviewRating","rating","reviewCount","review","address","$$eval","divs","Array","from","map","div","innerText","find","timeout","website","link","test","phone","latLong","getLatLong","returnObj","shop","trim","reviews","replace","latitude","longitude","getLinks","newScrollHeight","scrollHeight","divSelector","evaluate","document","querySelector","scrollTo","waitForTimeout","searchResults","querySelectorAll","el","href","filter","match","latLongStartIndex","indexOf","latLongEndIndex","latLongData","substring","split","webview","getElementById","loadURL","removeEventListener","addEventListener","maxLinks","newPage","gmapInitUrl","waitForNavigation","waitUntil","delay","keyboard","press","allLinks","linkCount","elements","some","push","getAttribute","click","length","no","empty","append","range","event","arg","chromeSet","setup","_getDefaultOsPath","logError","logInfo","exportLogs","logsPath"],"mappings":"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","file":"index.js","sourcesContent":["//#region Imports\r\n// Library ----------------------------------------------------------------------------------\r\nimport electron from 'electron';\r\nimport { Logger } from './lib/logger';\r\nimport { FilePaths } from './lib/file-paths.js';\r\nimport { PuppeteerWrapper } from './lib/puppeteer-wrapper';\r\nimport $ from 'jquery';\r\nimport JSONdb from 'simple-json-db';\r\nimport axios from 'axios';\r\nimport delay from 'delay';\r\nimport os from 'os';\r\nimport md5 from 'md5';\r\n//#endregion\r\n\r\n//#region Setup - Dependency Injection-----------------------------------------------\r\nconst _setting = new JSONdb('./settings.json');\r\nconst _logger = new Logger();\r\nconst _filePaths = new FilePaths(_logger, \"gmap-scrapper\");\r\nconst _ipcRenderer = electron.ipcRenderer;\r\nconst _puppeteerWrapper = new PuppeteerWrapper(_logger, _filePaths,\r\n\t{ headless: false, width: 900, height: 650 });\r\n\r\nlet scrapedData = [];\r\n//#endregion\r\n\r\n//#region Main ---------------------------------------------------------------------\r\n\r\nasync function main() {\r\n\tawait _puppeteerWrapper._getSavedPath();\r\n\r\n\tawait setPlatformText();\r\n\tawait getNetworkInterface();\r\n\r\n\t$('#licenseToText').text('Lisensi kepada: ' + _setting.get('user_email'));\r\n\r\n\t$('#searchBtn').on('click', async (e) => {\r\n\t\te.preventDefault();\r\n\r\n\t\t$('table tbody').html('<tr><td class=\"text-center\" colspan=\"9\">Hasil pencarian kosong</td></tr>');\r\n\t\t$('#statusTxt').removeClass('text-danger').removeClass('text-warning').addClass('text-success').text('Ready');\r\n\t\t$('#resultCountText').text('0');\r\n\r\n\t\tconst searchQuery = $('input#searchBusiness').val();\r\n\t\tconst searchLimit = parseInt($('select#searchLimit').val());\r\n\r\n\t\tif (searchQuery == \"\") {\r\n\t\t\t_ipcRenderer.send('empty-search-query', 'Kata kunci pencarian kosong.');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t$('input#searchBusiness').attr('disabled', 'disabled');\r\n\t\t$('input#searchLimit').attr('disabled', 'disabled');\r\n\r\n\t\tawait GMapScrapper(searchQuery, searchLimit);\r\n\t});\r\n\r\n\t$('#stopBtn').on('click', async (e) => {\r\n\t\te.preventDefault();\r\n\r\n\t\tawait _puppeteerWrapper.cleanup();\r\n\r\n\t\t$('#searchBtn').removeAttr('disabled');\r\n\t\t$(e.target).attr('disabled', 'disabled');\r\n\t\t$('#restartBtn').attr('disabled', 'disabled');\r\n\r\n\t\t$('input#searchBusiness').removeAttr('disabled');\r\n\t\t$('input#searchLimit').removeAttr('disabled');\r\n\t});\r\n\r\n\t$('#restartBtn').on('click', async (e) => {\r\n\t\te.preventDefault();\r\n\r\n\t\t$('table tbody').html('<tr><td class=\"text-center\" colspan=\"9\">Hasil pencarian kosong</td></tr>');\r\n\t\t$('#statusTxt').removeClass('text-danger').removeClass('text-warning').addClass('text-success').text('Ready');\r\n\t\t$('#resultCountText').text('0');\r\n\r\n\t\tawait _puppeteerWrapper.cleanup();\r\n\r\n\t\tconst searchQuery = $('input#searchBusiness').val();\r\n\t\tconst searchLimit = parseInt($('select#searchLimit').val());\r\n\r\n\t\tif (searchQuery == \"\") {\r\n\t\t\t_ipcRenderer.send('empty-search-query', 'Kata kunci pencarian kosong.');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tawait GMapScrapper(searchQuery, searchLimit);\r\n\t});\r\n\r\n\t$('#exportBtn').on('click', async (e) => {\r\n\t\t_ipcRenderer.send('export-to-xlsx', scrapedData);\r\n\t});\r\n\r\n\t$('#clearBtn').on('click', async (e) => {\r\n\t\t$('table tbody').html('<tr><td class=\"text-center\" colspan=\"9\">Hasil pencarian kosong</td></tr>');\r\n\t\t$('#statusTxt').removeClass('text-danger').removeClass('text-warning').addClass('text-success').text('Ready');\r\n\t\t$('#resultCountText').text('0');\r\n\r\n\t\tawait loadWebViewPage(\"https://www.google.com/maps/\");\r\n\t});\r\n\r\n\t$('#licenseForm').on('submit', async (e) => {\r\n\t\te.preventDefault();\r\n\r\n\t\tconst email = $('#emailAddress').val();\r\n\t\tconst key = $('#licenseKey').val();\r\n\r\n\t\tvalidateLicense(email, key);\r\n\t});\r\n}\r\n\r\nasync function setPlatformText() {\r\n\t$('#systemInfo').text(os.type() + \" \" + \" \" + os.platform() + \" \" + \" \" + os.arch() + \" \" + os.release());\r\n}\r\n\r\nasync function getNetworkInterface() {\r\n\tconst interfaces = os.networkInterfaces();\r\n\r\n\tfor (const key in interfaces) {\r\n\t\tif (interfaces.hasOwnProperty('Wi-Fi') ||\r\n\t\t\tinterfaces.hasOwnProperty('en1')) {\r\n\t\t\tconst wirelessNetwork = interfaces[key];\r\n\t\t\twirelessNetwork.forEach(ifcs => {\r\n\t\t\t\tlet mac = ifcs.hasOwnProperty('mac') ? ifcs['mac'] : '00:00:00:00:00:00';\r\n\t\t\t\tif (mac != '00:00:00:00:00:00') {\r\n\t\t\t\t\treturn mac;\r\n                }\r\n\t\t\t});\r\n        }\r\n    }\r\n}\r\n\r\nasync function validateLicense(email, licenseKey) {\r\n\tlet signature = _setting.get('signature');\r\n\r\n\tif (signature == undefined || signature == '') {\r\n\t\tconsole.log('Generate a new signature hash.');\r\n\r\n\t\tconst signatureParams = os.hostname() + \"-\" + getNetworkInterface();\r\n\t\tconst signatureHash = md5(signatureParams);\r\n\r\n\t\t_setting.set('signature', signatureHash);\r\n\r\n\t\tsignature = signatureHash;\r\n\t}\r\n\r\n\tconst baseUrl = _setting.get(\"license_server_url\") || 'https://license.pirantisofthouse.com';\r\n\tconst licenseServerUrl = `${baseUrl}/license-key/get?email=${email}&key=${licenseKey}&signature_hash=${signature}`;\r\n\r\n\ttry {\r\n\t\tconst response = await axios.get(licenseServerUrl);\r\n\t\tconst licenseData = response.data;\r\n\t\tconst status = licenseData.status;\r\n\r\n\t\t_setting.set('user_email', email);\r\n\t\t_setting.set('user_license', licenseKey);\r\n\r\n\t\tif (status === 1)\r\n\t\t\t_ipcRenderer.send('license-updated', \"success\");\r\n\t\telse\r\n\t\t\t_ipcRenderer.send('license-updated', \"failed\");\r\n\t} catch (ex) {\r\n\t\tconsole.log(ex);\r\n    }\r\n}\r\n\r\nasync function getPageData(url, page) {\r\n\tawait page.goto(url);\r\n\r\n\t//await loadWebViewPage(url);\r\n\r\n\t//Shop Name\r\n\tawait page.waitForSelector(\".x3AX1-LfntMc-header-title-title span\");\r\n\tconst shopName = await page.$eval(\r\n\t\t\".x3AX1-LfntMc-header-title-title span\",\r\n\t\t(name) => name.textContent\r\n\t);\r\n\r\n\tawait page.waitForSelector(\".x3AX1-LfntMc-header-title-ij8cu-haAclf\");\r\n\tconst reviewRating = await page.$eval(\r\n\t\t\".x3AX1-LfntMc-header-title-ij8cu-haAclf span > span > span\",\r\n\t\t(rating) => rating.textContent\r\n\t);\r\n\r\n\tawait page.waitForSelector(\".x3AX1-LfntMc-header-title-ij8cu-haAclf\");\r\n\tconst reviewCount = await page.$eval(\r\n\t\t\".x3AX1-LfntMc-header-title-ij8cu-haAclf span button.widget-pane-link\",\r\n\t\t(review) => review.textContent\r\n\t);\r\n\r\n\t//Shop Address\r\n\tawait page.waitForSelector(\".QSFF4-text.gm2-body-2:nth-child(1)\");\r\n\tlet address = await page.$$eval(\r\n\t\t\"#pane > div > div > div > div > div > div > button > div > div > div\",\r\n\t\t(divs) =>\r\n\t\t\tArray.from(divs)\r\n\t\t\t\t.map((div) => div.innerText)\r\n\t\t\t\t.find((address) => address)\r\n\t);\r\n\r\n\tif (address === undefined) {\r\n\t\taddress = await page.$$eval(\r\n\t\t\t\"#pane > div > div > div > div > div > div > button > div > div > div\",\r\n\t\t\t(divs) => divs[1]\r\n\t\t);\r\n\t}\r\n\r\n\t//Website\r\n\ttry {\r\n\t\tawait page.waitForSelector(\".HY5zDd\", { timeout: 3 });\r\n\t} catch (ex) {\r\n\t\tconsole.log('No element found.');\r\n\t}\r\n\r\n\tconst website = await page.$$eval(\r\n\t\t\"#pane > div > div > div > div > div > div > button > div > div > div\",\r\n\t\t(divs) =>\r\n\t\t\tArray.from(divs)\r\n\t\t\t\t.map((div) => div.innerText)\r\n\t\t\t\t.find((link) =>\r\n\t\t\t\t\t/^((https?|ftp|smtp):\\/\\/)?(www.)?[a-z0-9]+(\\.[a-z]{2,}){1,3}(#?\\/?[a-zA-Z0-9#]+)*\\/?(\\?[a-zA-Z0-9-_]+=[a-zA-Z0-9-%]+&?)?$/.test(\r\n\t\t\t\t\t\tlink\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t);\r\n\r\n\tconst phone = await page.$$eval(\r\n\t\t// \"#pane > div > div.widget-pane-content.cYB2Ge-oHo7ed > div > div > div:nth-child(9) > div:nth-child(2) > button > div.AeaXub > div.rogA2c > div.QSFF4-text.gm2-body-2\",\r\n\t\t'#pane > div > div.widget-pane-content.cYB2Ge-oHo7ed > div > div > div:nth-child(9) > div > button[data-item-id^=\"phone:tel:\"] div.QSFF4-text.gm2-body-2',\r\n\t\t(divs) =>\r\n\t\t\tArray.from(divs)\r\n\t\t\t\t.map((div) => div.innerText)\r\n\t\t\t\t.find((phone) => phone)\r\n\t);\r\n\r\n\tconst latLong = await getLatLong(url);\r\n\r\n\tlet returnObj = {\r\n\t\tshop: shopName.trim(),\r\n\t\trating: reviewRating === undefined ? '' : reviewRating.trim(),\r\n\t\treviews: reviewCount === undefined ? '' : reviewCount.trim(),\r\n\t\taddress: address === undefined ? '' : address.trim(),\r\n\t\twebsite: website === undefined ? '' : website.trim(),\r\n\t\tphone: phone === undefined ? '' : phone.trim().replace(/\\-/g, ''),\r\n\t\tlatitude: latLong[0],\r\n\t\tlongitude: latLong[1],\r\n\t};\r\n\r\n\treturn returnObj;\r\n\t//await browser.close();\r\n}\r\n\r\n//Get Links\r\nasync function getLinks(page) {\r\n\t// Scrolling to bottom of page\r\n\tlet newScrollHeight = 0;\r\n\tlet scrollHeight = 1000;\r\n\tlet divSelector = \"#pane > div > div > div > div > div:nth-child(4) > div\";\r\n\r\n\twhile (true) {\r\n\t\tawait page.waitForSelector(divSelector);\r\n\r\n\t\tawait page.evaluate(\r\n\t\t\t(scrollHeight, divSelector) =>\r\n\t\t\t\tdocument.querySelector(divSelector).scrollTo(0, scrollHeight),\r\n\t\t\tscrollHeight,\r\n\t\t\tdivSelector\r\n\t\t);\r\n\r\n\t\tawait page.waitForTimeout(500);\r\n\r\n\t\tnewScrollHeight = await page.$eval(\r\n\t\t\tdivSelector,\r\n\t\t\t(div) => div.scrollHeight\r\n\t\t);\r\n\r\n\t\tif (scrollHeight === newScrollHeight) {\r\n\t\t\tbreak;\r\n\t\t} else {\r\n\t\t\tscrollHeight = newScrollHeight;\r\n\t\t}\r\n\t}\r\n\r\n\t// Get results\r\n\tconst searchResults = await page.evaluate(() =>\r\n\t\tArray.from(document.querySelectorAll(\"a\"))\r\n\t\t\t.map((el) => el.href)\r\n\t\t\t.filter(\r\n\t\t\t\t(link) =>\r\n\t\t\t\t\tlink.match(/https:\\/\\/www.google.com\\/maps\\//g, link) &&\r\n\t\t\t\t\t!link.match(/\\=https:\\/\\/www.google.com\\/maps\\//g, link)\r\n\t\t\t)\r\n\t);\r\n\r\n\treturn searchResults;\r\n}\r\n\r\nasync function getLatLong(url) {\r\n\tconst latLongStartIndex = url.indexOf('!3d-') + 4;\r\n\tconst latLongEndIndex = url.indexOf('?');\r\n\tconst latLongData = url.substring(latLongStartIndex, latLongEndIndex).replace('!4d', ':');\r\n\r\n\treturn latLongData.split(\":\");\r\n}\r\n\r\nasync function loadWebViewPage(url) {\r\n\tconst webview = document.getElementById('gmapWv');\r\n\tawait webview.loadURL(url);\r\n\r\n\twebview.removeEventListener('dom-ready', loadWebViewPage);\r\n\twebview.addEventListener('dom-ready', loadWebViewPage);\r\n}\r\n\r\nasync function GMapScrapper(searchQuery = \"\", maxLinks = 100) {\r\n\tconsole.log('Start scrapping data.');\r\n\r\n\t// Make sure this variable empty\r\n\tscrapedData = [];\r\n\r\n\t$('#searchBtn').attr('disabled', 'disabled');\r\n\t$('#stopBtn').removeAttr('disabled');\r\n\t$('#restartBtn').removeAttr('disabled');\r\n\t$('#statusText span#statusTxt').removeClass('text-success').addClass('text-danger').text('Start scraping...');\r\n\r\n\tconst page = await _puppeteerWrapper.newPage();\r\n\r\n\tconst gmapInitUrl = \"https://www.google.com/maps/\"; // ?q=\" + searchQuery.replace(/\\s/g, '+');\r\n\t//const gmapInitUrl = \"https://www.google.com/maps/search/\" + searchQuery.replace(/\\s/g, '+');\r\n\r\n\tawait loadWebViewPage(gmapInitUrl + \"?q=\" + searchQuery.replace(/\\s/g, '+'));\r\n\r\n\tawait page.goto(gmapInitUrl);\r\n\tawait page.waitForNavigation({ waitUntil: \"domcontentloaded\" });\r\n\tawait page.waitForSelector('div#gs_lc50 input#searchboxinput');\r\n\r\n\tawait page.type('div#gs_lc50 input#searchboxinput', searchQuery, { delay: 100 });\r\n\tawait page.keyboard.press('Enter');\r\n\r\n\tlet allLinks = [];\r\n\tlet linkCount = 0;\r\n\r\n\twhile (\r\n\t\t!(await page.$$eval(\r\n\t\t\t\"#pane > div > div > div > div > div > div > div\",\r\n\t\t\t(elements) =>\r\n\t\t\t\tArray.from(elements).some(\r\n\t\t\t\t\t(el) => (el.innerText === \"Tidak ditemukan hasil\" || el.innerText === \"No results found\")\r\n\t\t\t\t)\r\n\t\t))\r\n\t) {\r\n\t\tif (maxLinks !== 0 && linkCount > maxLinks) break;\r\n\r\n\t\tallLinks.push(...(await getLinks(page)));\r\n\r\n\t\tawait page.$$eval(\"button\", (elements) => {\r\n\t\t\treturn Array.from(elements)\r\n\t\t\t\t.find((el) => (el.getAttribute(\"aria-label\") === \"Halaman berikutnya\" || el.getAttribute(\"aria-label\") === \"Next page\"))\r\n\t\t\t\t.click()\r\n\t\t});\r\n\r\n\t\tawait page.waitForNavigation({ waitUntil: \"load\" });\r\n\r\n\t\tlinkCount = allLinks.length;\r\n\r\n\t\t$('#statusText span#statusTxt').removeClass('text-danger').addClass('text-warning').text('Gathering links...');\r\n\r\n\t\tif (maxLinks == 0) {\r\n\t\t\t$('#resultCountText').text(linkCount);\r\n\t\t} else {\r\n\t\t\t$('#resultCountText').text(linkCount > maxLinks ? maxLinks : linkCount);\r\n\t\t}\r\n\t}\r\n\r\n\t$('#resultsTable tbody').html('<tr><td class=\"text-center\" colspan=\"9\"><p>Data sedang diproses...</p></td></tr>');\r\n\r\n\tlet no = 1;\r\n\tfor (let link of allLinks) {\r\n\t\tif(maxLinks !== 0 && no > maxLinks) break;\r\n\r\n\t\t$('#statusText span#statusTxt').removeClass('text-warning').addClass('text-success').text('Processing \"'+link+'\"');\r\n\r\n\t\tconst data = await getPageData(link, page);\r\n\r\n\t\tif (no === 1) $('#resultsTable tbody').empty();\r\n\r\n\t\t$('#resultsTable tbody').append(`\r\n\t\t\t<tr>\r\n\t\t\t\t<th scope=\"row\">${no}</th>\r\n\t\t\t\t<td>${data.shop}</td>\r\n\t\t\t\t<td>${data.address}</td>\r\n\t\t\t\t<td>${data.phone}</td>\r\n\t\t\t\t<td>${data.website}</td>\r\n\t\t\t\t<td>${data.rating}</td>\r\n\t\t\t\t<td>${data.reviews}</td>\r\n\t\t\t\t<td>${data.latitude}</td>\r\n\t\t\t\t<td>${data.longitude}</td>\r\n\t\t\t</tr>\r\n\t\t`);\r\n\t\tscrapedData.push(data);\r\n\t\tno++;\r\n\r\n\t\tawait delay.range(100, 1000);\r\n\t}\r\n\r\n\t$('#searchBtn').removeAttr('disabled');\r\n\t$('#stopBtn').attr('disabled', 'disabled');\r\n\t$('#restartBtn').attr('disabled', 'disabled');\r\n\r\n\t$('input#searchBusiness').removeAttr('disabled');\r\n\t$('input#searchLimit').removeAttr('disabled');\r\n\r\n\tawait _puppeteerWrapper.cleanup();\r\n\r\n\t$('#statusText span#statusTxt').removeClass('text-danger').addClass('text-success').text('Done!');\r\n}\r\n\r\n_ipcRenderer.on('chrome-path-is-set', (event, arg) => {\r\n\t$('span#chromeInfo').addClass('text-success').text(arg);\r\n});\r\n\r\n(async () => {\r\n\ttry {\r\n\t\tconst chromeSet = await _puppeteerWrapper.setup();\r\n\t\tif (!chromeSet) {\r\n\t\t\t_ipcRenderer.send('chrome-not-found');\r\n\t\t} else {\r\n\t\t\t$('span#chromeInfo').addClass('text-success').text(await _puppeteerWrapper._getSavedPath() || await _puppeteerWrapper._getDefaultOsPath());\r\n        }\r\n\r\n\t\tawait main();\r\n\t} catch (e) {\r\n\t\t_logger.logError('Thrown error:');\r\n\t\t_logger.logError(e);\r\n\t} finally {\r\n\t\tawait _puppeteerWrapper.cleanup();\r\n\t}\r\n\r\n\t_logger.logInfo('Done. Close window to exit');\r\n\r\n\tawait _logger.exportLogs(_filePaths.logsPath());\r\n})();\r\n\r\n//#endregion\r\n"]}